# =============================================================================
# DevOps AI Assistant - Backend Requirements
# =============================================================================
# This file contains CPU-optimized dependencies for the RAG system.
# For GPU acceleration, see requirements-gpu.txt
# =============================================================================

# -----------------------------------------------------------------------------
# Core FastAPI Dependencies
# -----------------------------------------------------------------------------
fastapi>=0.109.0
uvicorn[standard]>=0.27.0
pydantic>=2.5.0
pydantic-settings>=2.1.0

# -----------------------------------------------------------------------------
# LLM and RAG Core
# -----------------------------------------------------------------------------
langchain>=0.1.0
langchain-community>=0.0.20
langchain-core>=0.1.0
langchain-text-splitters>=0.0.1
ollama>=0.1.6

# Phase 2: Semantic chunking support
langchain-experimental>=0.0.50

# -----------------------------------------------------------------------------
# Vector Store
# -----------------------------------------------------------------------------
# Pinned to be compatible with server v1.12.4 (minor version diff must be <= 1)
qdrant-client>=1.11.0,<1.14.0

# -----------------------------------------------------------------------------
# Embeddings and Reranking
# -----------------------------------------------------------------------------
langchain-huggingface>=0.1.0
# sentence-transformers includes cross-encoder models for reranking
# Models used: all-MiniLM-L6-v2 (embedding), cross-encoder/ms-marco-MiniLM-L-6-v2 (reranking)
sentence-transformers>=2.3.0

# -----------------------------------------------------------------------------
# Hybrid Search (Phase 4)
# -----------------------------------------------------------------------------
# fastembed for BM25 sparse vector generation (hybrid search)
# Model used: Qdrant/bm25 for sparse embeddings
fastembed>=0.2.0

# PyTorch - CPU version installed separately in Dockerfile for smaller image
# See requirements-gpu.txt for CUDA-enabled PyTorch
torch>=2.1.0

# -----------------------------------------------------------------------------
# Redis for Conversation Memory
# -----------------------------------------------------------------------------
redis>=5.0.0
hiredis>=2.3.0

# -----------------------------------------------------------------------------
# PostgreSQL Database
# -----------------------------------------------------------------------------
# Async PostgreSQL driver for high-performance database operations
asyncpg>=0.29.0
# SQLAlchemy with async support for ORM and query building
sqlalchemy[asyncio]>=2.0.25
# Sync PostgreSQL adapter (fallback for migrations, scripts)
psycopg2-binary>=2.9.9

# -----------------------------------------------------------------------------
# Document Processing
# -----------------------------------------------------------------------------
unstructured>=0.12.0
markdown>=3.5.0

# Phase 2: Enhanced text processing for semantic chunking
nltk>=3.8.0
spacy>=3.7.0

# -----------------------------------------------------------------------------
# HTTP Clients
# -----------------------------------------------------------------------------
# Note: ollama requires httpx<0.26.0
httpx>=0.25.2,<0.26.0
aiohttp>=3.9.0

# -----------------------------------------------------------------------------
# Observability and Metrics (Phase 2)
# -----------------------------------------------------------------------------
# Prometheus metrics for monitoring RAG pipeline performance
prometheus-client>=0.19.0
# Structured logging enhancement
python-json-logger>=2.0.0

# -----------------------------------------------------------------------------
# Utilities
# -----------------------------------------------------------------------------
python-dotenv>=1.0.0
python-multipart>=0.0.6
loguru>=0.7.0
tqdm>=4.66.0

# -----------------------------------------------------------------------------
# Testing
# -----------------------------------------------------------------------------
pytest>=7.4.0
pytest-asyncio>=0.23.0
pytest-cov>=4.1.0
httpx>=0.25.2,<0.26.0  # For TestClient

# -----------------------------------------------------------------------------
# Development (optional - uncomment if needed)
# -----------------------------------------------------------------------------
# black>=24.0.0
# ruff>=0.1.0
# mypy>=1.8.0
# pre-commit>=3.6.0
